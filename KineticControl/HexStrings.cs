using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Net;
using System.Text;

namespace KineticControl
{
    class HexStrings
    {
        private const String PS_SEARCH = "0401dc4a01000100000000000a0101de";

        //this is broadcast to 255.255.255.255 5 times
        private const String _fullSearch = "0401dc4a0100090100000000201c4402";
        //then we wait 1 second and broadcast this to my1.my2.my3.255 5 times
        private const String _partialSearch = "0401dc4a0100090100000000ffffffff";
        //then we wait 10ms and broadcast this to my1.my2.my3.255 once
        private const String _finalSearch = "0401dc4a0100010000000000"; //end with the hex form of a ip address to broadcast from eg. c0a80189 = 192.168.1.137
        //after this it should reply from the ip address you specified with _finalSearch. bytes 12-15 will contain the actual IP address of the device
        //The final 98 bytes, starting from byte 32, will contain the description of the device in the form:
        //M:Color Kinetics Incorporated\x0AD:<model>\x0A#:SFT-000112-00\x0AR:00<padding to 98 bytes with \x00>
 
        //Known Models:
        //SPDS-480ca - 8 ports
        //SPDS-60ca - 2 ports


        public static byte[] LocalRequestHex(IPAddress responseIP)
        {
            String hexString = _finalSearch + EncodeBytes(responseIP.GetAddressBytes());
            return DecodeString(hexString);
        }

        private const String _findOne =  "0401dc4a0100090100000000a0310567";
        private const String _findTwo =  "0401dc4a0100010000000000a9fe8889";
        private static String _findThree = "0401dc4a01000100000000000a0101de";
        private static String _findFour = "0401dc4a01000a00a9fe319af8acfe03";
        public const String addressOff = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

        public const String pds480Lead =      "0401dc4a0100080100000000ffffffff01df000000020000";
        public const string byteStringOne =   "0401dc4a01000801000000000000000001ef00000002f0ff0000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" + 
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000";

        public const string byteStringTwo =   "0401dc4a01000801000000000000000002ef00000002f0ff" + "44499900000000FF000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                                              "000000000000000000000000000000000000000000000000000";

        public const string byteStringThree = "0401dc4a010008010000000000000000021b00000002f0ff00000000000000000000000000000000000000000000"+
                                              "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"+
                                              "000000000000000000000000000000000000000000000000000000";


        public static byte[] FullSearch
        {
            get { return DecodeString(_fullSearch); }
        }

        public static byte[] PartialSearch
        {
            get { return DecodeString(_partialSearch); }
        }

        public static byte[] PsSearch
        {
            get { return DecodeString(PS_SEARCH); }
        }

        public static byte[] DataOne
        {
            get { return DecodeString(_findOne); }
        }

        public static byte[] DataTwo
        {
            get { return DecodeString(_findTwo); }
        }

        public static byte[] DataThree
        {
            get { return DecodeString(_findThree); }
        }

        public static byte[] DataFour
        {
            get { return DecodeString(_findFour); }
        }

        public static byte[] AddressOff
        {
            get { return DecodeString(addressOff); }
        }

        public static String EncodeBytes(byte[] bytes)
        {
            return BitConverter.ToString(bytes).Replace("-", String.Empty);
        }

        public static byte[] DecodeString(String hexString)
        {
            byte[] hexBytes = new byte[hexString.Length / 2];
            for (int i = 0; i < hexString.Length / 2; i++)
            {
                hexBytes[i] = Byte.Parse(hexString.Substring(i * 2, 2).ToUpper(), NumberStyles.AllowHexSpecifier);
            }
            return hexBytes;
        }
    }
}
